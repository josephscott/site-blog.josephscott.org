{
    "version": "https://jsonfeed.org/version/1.1",
    "user_comment": "This feed allows you to read the posts from this site in any feed reader that supports the JSON Feed format. To add this feed to your reader, copy the following URL -- https://blog.josephscott.org/tag/sqlserver/feed/json/ -- and add it your reader.",
    "home_page_url": "https://blog.josephscott.org/tag/sqlserver/",
    "feed_url": "https://blog.josephscott.org/tag/sqlserver/feed/json/",
    "language": "en-US",
    "title": "sqlserver &#8211; Joseph Scott",
    "items": [
        {
            "id": "http://joseph.randomnetworks.com/archives/2007/10/25/sql-server-extension-for-php-from-microsoft/",
            "url": "https://blog.josephscott.org/2007/10/25/sql-server-extension-for-php-from-microsoft/",
            "title": "SQL Server Extension for PHP from Microsoft",
            "content_html": "<p>Earlier this month Microsoft contributed a <a href=\"http://www.microsoft.com/sql/technologies/php/default.mspx\">SQL Server Driver for PHP</a>.  They even have a <a href=\"http://blogs.msdn.com/sqlphp/\">SQL Server and PHP blog</a> and their <a href=\"http://forums.microsoft.com/MSDN/ShowForum.aspx?ForumID=87&amp;SiteID=1\">SQL Server forum</a> now lists as PHP in their client list.  The blog has an interesting post on <a href=\"http://blogs.msdn.com/sqlphp/archive/2007/10/11/transparency-in-the-design-process.aspx\">development of the driver</a>.</p>\n<p>So, what does this thing do?  It is for PHP5 only (not a big deal considering PHP4 will only be getting security updates after this year) on Windows (this part is a bummer, but not surprising) to access SQL Server 2000 and 2005 (anyone running anything older than that in production?).</p>\n<p>You could work with SQL Server from PHP prior to this using <a href=\"http://www.freetds.org/\">FreeTDS</a>.  I&#8217;ve used the <a href=\"http://php.net/mssql\">mssql_* PHP functions</a> backed by FreeTDS on FreeBSD for years so this new driver from Microsoft isn&#8217;t a major game changer at this point.</p>\n<p>That said, I find this a pretty exciting development.</p>\n<p>Microsoft is actually providing a PHP library to work with some of their own software.  I think that is great, although the really huge win would have been if it was available for non-Microsoft operating systems.  This is great stuff though, not just talk, but real live code.  Combining this with <a href=\"http://joseph.randomnetworks.com/archives/2007/09/24/php-on-iis/\">better PHP on IIS support</a> I have a glimmer of hope that we&#8217;ll see more good things from Microsoft for PHP.</p>\n<p>There has been plenty of PR about Microsoft doing more in this area, but providing real code and tools is what we actually need.</p>\n",
            "content_text": "Earlier this month Microsoft contributed a SQL Server Driver for PHP.  They even have a SQL Server and PHP blog and their SQL Server forum now lists as PHP in their client list.  The blog has an interesting post on development of the driver.\nSo, what does this thing do?  It is for PHP5 only (not a big deal considering PHP4 will only be getting security updates after this year) on Windows (this part is a bummer, but not surprising) to access SQL Server 2000 and 2005 (anyone running anything older than that in production?).\nYou could work with SQL Server from PHP prior to this using FreeTDS.  I&#8217;ve used the mssql_* PHP functions backed by FreeTDS on FreeBSD for years so this new driver from Microsoft isn&#8217;t a major game changer at this point.\nThat said, I find this a pretty exciting development.\nMicrosoft is actually providing a PHP library to work with some of their own software.  I think that is great, although the really huge win would have been if it was available for non-Microsoft operating systems.  This is great stuff though, not just talk, but real live code.  Combining this with better PHP on IIS support I have a glimmer of hope that we&#8217;ll see more good things from Microsoft for PHP.\nThere has been plenty of PR about Microsoft doing more in this area, but providing real code and tools is what we actually need.",
            "date_published": "2007-10-25T07:00:48-06:00",
            "date_modified": "2007-10-25T07:00:48-06:00",
            "authors": [
                {
                    "name": "josephscott",
                    "url": "https://blog.josephscott.org/author/josephscott/",
                    "avatar": "https://secure.gravatar.com/avatar/582b66ad5ae1b69c7601a990cb9a661a?s=512&d=mm&r=g"
                }
            ],
            "author": {
                "name": "josephscott",
                "url": "https://blog.josephscott.org/author/josephscott/",
                "avatar": "https://secure.gravatar.com/avatar/582b66ad5ae1b69c7601a990cb9a661a?s=512&d=mm&r=g"
            },
            "tags": [
                "microsoft",
                "PHP",
                "sqlserver",
                "josephscott"
            ]
        },
        {
            "id": "http://joseph.randomnetworks.com/archives/2006/09/29/sql-server-escaping-the-database-name/",
            "url": "https://blog.josephscott.org/2006/09/29/sql-server-escaping-the-database-name/",
            "title": "SQL Server: Escaping The Database Name",
            "content_html": "<p>Welcome to another episode of being caught off guard by strange string requirements.  Today I discovered (the hard way of course) that Microsoft SQL Server 2000 doesn&#8217;t like to have dashes in database names.  Fine, I probably should have used an underscore instead, but this was a database being used for something else that I just need to do some quick queries against in PHP.</p>\n<p>I knew that the connection between the web server and the SQL Server systems was working because I had scripts talking to other SQL Server databases.  My problem wasn&#8217;t connecting, <a href=\"http://us3.php.net/manual/en/function.mssql-connect.php\">mssql_connect()</a> didn&#8217;t cause an error, it was selecting which database to use.  Fortunately the answer was right there in the docs for <a href=\"http://us3.php.net/manual/en/function.mssql-select-db.php\">mssql_select_db()</a>:</p>\n<blockquote><p>\nTo escape the name of a database that contains spaces, hyphens (&#8220;-&#8220;), or any other exceptional characters, the database name must be enclosed in brackets, as is shown in the example, below. This technique must also be applied when selecting a database name that is also a reserved word (such as &#8220;primary&#8221;).\n</p></blockquote>\n<p>So just get in the habit of wrapping your SQL Server database name in brackets ( [ ] ) and you&#8217;ll be fine:</p>\n<pre>\n   $conn = mssql_connect('SQLSERVERHOST', 'username', 'password');\n   mssql_select_db('[database-name]', $conn);\n</pre>\n<p>What I want to know is, why brackets around the whole name instead of traditional character escaping?</p>\n",
            "content_text": "Welcome to another episode of being caught off guard by strange string requirements.  Today I discovered (the hard way of course) that Microsoft SQL Server 2000 doesn&#8217;t like to have dashes in database names.  Fine, I probably should have used an underscore instead, but this was a database being used for something else that I just need to do some quick queries against in PHP.\nI knew that the connection between the web server and the SQL Server systems was working because I had scripts talking to other SQL Server databases.  My problem wasn&#8217;t connecting, mssql_connect() didn&#8217;t cause an error, it was selecting which database to use.  Fortunately the answer was right there in the docs for mssql_select_db():\n\nTo escape the name of a database that contains spaces, hyphens (&#8220;-&#8220;), or any other exceptional characters, the database name must be enclosed in brackets, as is shown in the example, below. This technique must also be applied when selecting a database name that is also a reserved word (such as &#8220;primary&#8221;).\n\nSo just get in the habit of wrapping your SQL Server database name in brackets ( [ ] ) and you&#8217;ll be fine:\n\n   $conn = mssql_connect('SQLSERVERHOST', 'username', 'password');\n   mssql_select_db('[database-name]', $conn);\n\nWhat I want to know is, why brackets around the whole name instead of traditional character escaping?",
            "date_published": "2006-09-29T09:52:20-06:00",
            "date_modified": "2006-09-29T09:52:20-06:00",
            "authors": [
                {
                    "name": "josephscott",
                    "url": "https://blog.josephscott.org/author/josephscott/",
                    "avatar": "https://secure.gravatar.com/avatar/582b66ad5ae1b69c7601a990cb9a661a?s=512&d=mm&r=g"
                }
            ],
            "author": {
                "name": "josephscott",
                "url": "https://blog.josephscott.org/author/josephscott/",
                "avatar": "https://secure.gravatar.com/avatar/582b66ad5ae1b69c7601a990cb9a661a?s=512&d=mm&r=g"
            },
            "tags": [
                "mssql_select_db",
                "PHP",
                "sqlserver",
                "josephscott"
            ]
        },
        {
            "id": "http://joseph.randomnetworks.com/archives/2006/06/22/sql-server-convert/",
            "url": "https://blog.josephscott.org/2006/06/22/sql-server-convert/",
            "title": "SQL Server CONVERT()",
            "content_html": "<p><span style=\"float: left;padding: 10px\"></p>\n<p></span><br />\nI recently had the need format a datetime field in SQL Server 2000.  My first thought was to look for <a href=\"http://www.postgresql.org/docs/8.1/static/functions-formatting.html\">to_char()</a>, which does the job in <a href=\"http://www.postgresql.org/\">PostgreSQL</a> and <a href=\"http://www.oracle.com/\">Oracle</a>.  No luck there because SQL Server doesn&#8217;t have a to_char() function.  After some hunting around I found out about the <a href=\"http://msdn.microsoft.com/library/default.asp?url=/library/en-us/tsqlref/ts_ca-co_2f3o.asp\">convert()</a> function.  This does the same thing as to_char() (more or less) but instead of using traditional date formatting codes, &#8220;style codes&#8221;.</p>\n<p>Yes, you read that right.  Instead of being able to get a four digit year by specifying Y or YYYY, you have to look up the style code that matches the format you want.  In my case I was look for DD MON YYYY format.  This turns out to be style code 106.  Here is an example:</p>\n<pre>\nSELECT CONVERT(VARCHAR(11), datetime_field, 106) AS formatted_date\n</pre>\n<p>Some time with <a href=\"http://www.google.com/\">Google</a> turned up a page listing <a href=\"http://www.sql-server-helper.com/tips/date-formats.aspx\">examples of various style codes</a>.  Here is <a href=\"http://sqljunkies.com/Article/6676BEAE-1967-402D-9578-9A1C7FD826E5.scuk\">another one</a> about 40% down the page.</p>\n<p>There is an alternative to convert(), <a href=\"http://support.microsoft.com/default.aspx?scid=kb;EN-US;q186265\">datepart()</a>.  This allows you to pull out specific parts of the datetime field.  So you could do the same thing as the convert() example above, but it would be much more verbose.</p>\n<p><b>UPDATE Fri 7 Jul 2006 @ 11:30am :</b> I really should have included a list at least some of the format codes in this post for future reference:</p>\n<ul>\n<li>100 &#8211; mon dd yyyy hh:miAM (or PM)</li>\n<li>101 &#8211; mm/dd/yy</li>\n<li>106 &#8211; dd mon yy</li>\n<li>108 &#8211; hh:mm:ss</li>\n<li>109 &#8211; mon dd yyyy hh:mi:ss:mmmAM (or PM)</li>\n<li>130 &#8211; dd mon yyyy hh:mi:ss:mmmAM (or PM)</li>\n</ul>\n",
            "content_text": "I recently had the need format a datetime field in SQL Server 2000.  My first thought was to look for to_char(), which does the job in PostgreSQL and Oracle.  No luck there because SQL Server doesn&#8217;t have a to_char() function.  After some hunting around I found out about the convert() function.  This does the same thing as to_char() (more or less) but instead of using traditional date formatting codes, &#8220;style codes&#8221;.\nYes, you read that right.  Instead of being able to get a four digit year by specifying Y or YYYY, you have to look up the style code that matches the format you want.  In my case I was look for DD MON YYYY format.  This turns out to be style code 106.  Here is an example:\n\nSELECT CONVERT(VARCHAR(11), datetime_field, 106) AS formatted_date\n\nSome time with Google turned up a page listing examples of various style codes.  Here is another one about 40% down the page.\nThere is an alternative to convert(), datepart().  This allows you to pull out specific parts of the datetime field.  So you could do the same thing as the convert() example above, but it would be much more verbose.\nUPDATE Fri 7 Jul 2006 @ 11:30am : I really should have included a list at least some of the format codes in this post for future reference:\n\n100 &#8211; mon dd yyyy hh:miAM (or PM)\n101 &#8211; mm/dd/yy\n106 &#8211; dd mon yy\n108 &#8211; hh:mm:ss\n109 &#8211; mon dd yyyy hh:mi:ss:mmmAM (or PM)\n130 &#8211; dd mon yyyy hh:mi:ss:mmmAM (or PM)",
            "date_published": "2006-06-22T21:53:41-06:00",
            "date_modified": "2006-06-22T21:53:41-06:00",
            "authors": [
                {
                    "name": "josephscott",
                    "url": "https://blog.josephscott.org/author/josephscott/",
                    "avatar": "https://secure.gravatar.com/avatar/582b66ad5ae1b69c7601a990cb9a661a?s=512&d=mm&r=g"
                }
            ],
            "author": {
                "name": "josephscott",
                "url": "https://blog.josephscott.org/author/josephscott/",
                "avatar": "https://secure.gravatar.com/avatar/582b66ad5ae1b69c7601a990cb9a661a?s=512&d=mm&r=g"
            },
            "tags": [
                "convert",
                "datepart",
                "sql",
                "sqlserver",
                "to_char",
                "josephscott"
            ]
        },
        {
            "id": "http://joseph.randomnetworks.com/archives/2006/04/10/replicating-from-ms-sql-server-to-postgresql/",
            "url": "https://blog.josephscott.org/2006/04/10/replicating-from-ms-sql-server-to-postgresql/",
            "title": "Replicating from MS SQL Server to PostgreSQL",
            "content_html": "<p>Mangus Hagander has a detailed how to for <a href=\"http://people.planetpostgresql.org/mha/index.php?/archives/87-guid.html\">replicating from MS SQL Server to PostgreSQL</a>.  It certainly isn&#8217;t perfect, but for those willing to go through the work this would be a very interesting way to add <a href=\"http://www.postgresql.org/\">PostgreSQL</a> to a SQL Server shop.  I don&#8217;t plan on using this right now, but I&#8217;m definitely going to file this away as something with potential.</p>\n",
            "content_text": "Mangus Hagander has a detailed how to for replicating from MS SQL Server to PostgreSQL.  It certainly isn&#8217;t perfect, but for those willing to go through the work this would be a very interesting way to add PostgreSQL to a SQL Server shop.  I don&#8217;t plan on using this right now, but I&#8217;m definitely going to file this away as something with potential.",
            "date_published": "2006-04-10T13:17:27-06:00",
            "date_modified": "2006-04-10T13:17:27-06:00",
            "authors": [
                {
                    "name": "josephscott",
                    "url": "https://blog.josephscott.org/author/josephscott/",
                    "avatar": "https://secure.gravatar.com/avatar/582b66ad5ae1b69c7601a990cb9a661a?s=512&d=mm&r=g"
                }
            ],
            "author": {
                "name": "josephscott",
                "url": "https://blog.josephscott.org/author/josephscott/",
                "avatar": "https://secure.gravatar.com/avatar/582b66ad5ae1b69c7601a990cb9a661a?s=512&d=mm&r=g"
            },
            "tags": [
                "Database",
                "PostgreSQL",
                "replication",
                "sqlserver",
                "josephscott"
            ]
        },
        {
            "id": "http://joseph.randomnetworks.com/archives/2006/03/21/overcoming-the-limitation-of-information_schemaviews-in-sql-server-2000/",
            "url": "https://blog.josephscott.org/2006/03/21/overcoming-the-limitation-of-information_schemaviews-in-sql-server-2000/",
            "title": "Overcoming The Limitation Of Information_Schema.Views In SQL Server 2000",
            "content_html": "<p>This morning I went on a hunt to find out where SQL Server 2000 keeps the view definitions for a database.  I quickly came across information_schema feature (seems that having information_schema is part of the <a href=\"http://www.contrib.andrew.cmu.edu/~shadow/sql/sql1992.txt\">SQL92</a> standard) which exposes view details via <a href=\"http://www.transactsql.com/html/infoschemaviews.html\">information_schema.views</a>.  I was hoping that would be the end of my journey, but then I ran into a problem.</p>\n<p>Go back and look at the details for the <a href=\"http://www.transactsql.com/html/infoschemaviews.html\">Information_Schema.Views</a>, pay close attention to the VIEW_DEFINITION column.  It turns out that if the view definition is more than 4000 characters then it returns NULL.  Why they didn&#8217;t just make it a TEXT field I do not know.  Of course one of the two view definitions that I was looking for was returning NULL.  At least I had figured out why, now I needed to know how to get around it.</p>\n<p>I knew I could not have been the only one to run into this, so it was back to searching for a solution.  I eventually came across a <a href=\"http://www.experts-exchange.com/Databases/Microsoft_SQL_Server/Q_20634183.html\">post about sp_helptext</a> that gets around the 4000 character limit.  It turns out that <a href=\"http://msdn2.microsoft.com/en-us/library/ms176112.aspx\">sp_helptext</a> will not only give you a view definition, but also triggers, functions, check constraints and stored procedures.  Quite handy to have around.  So I was able to get the view definition I was looking for (broken up across multiple rows) with:</p>\n<p><code><br />\nEXEC sp_helptext 'my_view_name'<br />\n</code></p>\n<p>You&#8217;ll still have to put all the rows back together to get the complete view definition, but that it much better than just getting NULL.  Of course if I could figure out what the Information_Schema.Views or sp_helptext is looking at to get the actual view definition I could do it myself.  So far I haven&#8217;t been able to find that information, and I&#8217;m not sure that I&#8217;m going to spend much time looking since I have a workable solution at this point.</p>\n<p>As an added bonus, go back to the <a href=\"http://www.transactsql.com/html/infoschemaviews.html\">Information_Schema.Views</a> page again and take a look at the IS_UPDATABLE column notes.  Turns out that it always returns NO.</p>\n<p>While it was nice of Microsoft to include the Information_Schema.Views as part of SQL Server 2000, don&#8217;t depend on the data they provide, in some cases it will be wrong.  I haven&#8217;t looked to see if this is something that has been fixed in SQL Server 2005.</p>\n<p><b>UPDATE Tue 21 Mar 2006 @ 4:00pm:</b> Turns out that getting the definitions of the Information_Schema.Views and sp_helptext is fairly simple.  They are kept in the master database in SQL Server 2000.  Connect to the master database and take a look at the views, you&#8217;ll see several that are owned by INFORMATION_SCHEMA.  Then take a look at the listing for Stored Procedures.  There are tons of sp_* procedures, one of which is sp_helptext.  This lead me to running <code>exec sp_helptext 'sp_helptext'</code> to get the definition of sp_helptext.  You can also look at it by looking at the properties of sp_helptext, but you&#8217;ll be doing a lot scrolling in a little tiny window.  Ick.</p>\n<p>After looking at the definitions of both I think I&#8217;m going to stick with sp_helptext.</p>\n<p><b> UPDATE Tue 21 Mar 2006 @ 4:40pm:</b> Here is the MSDN info on <a href=\"http://msdn.microsoft.com/library/default.asp?url=/library/en-us/tsqlref/ts_ia-iz_4pbn.asp\">INFORMATION_SCHEMA</a> and more specifically <a href=\"http://msdn.microsoft.com/library/default.asp?url=/library/en-us/tsqlref/ts_ia-iz_4fqr.asp\">INFORMATION_SCHEMA.VIEWS</a> which includes notes about the limit of 4000 characters to view_definition and that is_updatable always returns no.</p>\n",
            "content_text": "This morning I went on a hunt to find out where SQL Server 2000 keeps the view definitions for a database.  I quickly came across information_schema feature (seems that having information_schema is part of the SQL92 standard) which exposes view details via information_schema.views.  I was hoping that would be the end of my journey, but then I ran into a problem.\nGo back and look at the details for the Information_Schema.Views, pay close attention to the VIEW_DEFINITION column.  It turns out that if the view definition is more than 4000 characters then it returns NULL.  Why they didn&#8217;t just make it a TEXT field I do not know.  Of course one of the two view definitions that I was looking for was returning NULL.  At least I had figured out why, now I needed to know how to get around it.\nI knew I could not have been the only one to run into this, so it was back to searching for a solution.  I eventually came across a post about sp_helptext that gets around the 4000 character limit.  It turns out that sp_helptext will not only give you a view definition, but also triggers, functions, check constraints and stored procedures.  Quite handy to have around.  So I was able to get the view definition I was looking for (broken up across multiple rows) with:\n\nEXEC sp_helptext 'my_view_name'\n\nYou&#8217;ll still have to put all the rows back together to get the complete view definition, but that it much better than just getting NULL.  Of course if I could figure out what the Information_Schema.Views or sp_helptext is looking at to get the actual view definition I could do it myself.  So far I haven&#8217;t been able to find that information, and I&#8217;m not sure that I&#8217;m going to spend much time looking since I have a workable solution at this point.\nAs an added bonus, go back to the Information_Schema.Views page again and take a look at the IS_UPDATABLE column notes.  Turns out that it always returns NO.\nWhile it was nice of Microsoft to include the Information_Schema.Views as part of SQL Server 2000, don&#8217;t depend on the data they provide, in some cases it will be wrong.  I haven&#8217;t looked to see if this is something that has been fixed in SQL Server 2005.\nUPDATE Tue 21 Mar 2006 @ 4:00pm: Turns out that getting the definitions of the Information_Schema.Views and sp_helptext is fairly simple.  They are kept in the master database in SQL Server 2000.  Connect to the master database and take a look at the views, you&#8217;ll see several that are owned by INFORMATION_SCHEMA.  Then take a look at the listing for Stored Procedures.  There are tons of sp_* procedures, one of which is sp_helptext.  This lead me to running exec sp_helptext 'sp_helptext' to get the definition of sp_helptext.  You can also look at it by looking at the properties of sp_helptext, but you&#8217;ll be doing a lot scrolling in a little tiny window.  Ick.\nAfter looking at the definitions of both I think I&#8217;m going to stick with sp_helptext.\n UPDATE Tue 21 Mar 2006 @ 4:40pm: Here is the MSDN info on INFORMATION_SCHEMA and more specifically INFORMATION_SCHEMA.VIEWS which includes notes about the limit of 4000 characters to view_definition and that is_updatable always returns no.",
            "date_published": "2006-03-21T11:56:05-07:00",
            "date_modified": "2006-03-21T11:56:05-07:00",
            "authors": [
                {
                    "name": "josephscott",
                    "url": "https://blog.josephscott.org/author/josephscott/",
                    "avatar": "https://secure.gravatar.com/avatar/582b66ad5ae1b69c7601a990cb9a661a?s=512&d=mm&r=g"
                }
            ],
            "author": {
                "name": "josephscott",
                "url": "https://blog.josephscott.org/author/josephscott/",
                "avatar": "https://secure.gravatar.com/avatar/582b66ad5ae1b69c7601a990cb9a661a?s=512&d=mm&r=g"
            },
            "tags": [
                "information_schema",
                "sp_helptext",
                "sqlserver",
                "view",
                "josephscott"
            ]
        },
        {
            "id": "http://joseph.randomnetworks.com/?p=413",
            "url": "https://blog.josephscott.org/2005/06/16/sql-server-2000-notes/",
            "title": "SQL Server 2000 Notes",
            "content_html": "<p>We are purchasing some software at work that uses <a href=\"http://www.microsoft.com/sql/default.mspx\">SQL Server 2000</a> as a back end.  I&#8217;ve been bringing those systems up and relearning SQL Server since I haven&#8217;t look at it in more than five years.  We&#8217;ll be importing some existing data for this software so I&#8217;ve started writing up a few scripts.  I&#8217;m using <a href=\"http://www.php.net/\">PHP</a> with <a href=\"http://adodb.sourceforge.net/\">ADOdb</a> for database access.  For the most part things have gone well, with some small expections/gotchas.  Fortunately none of the problems I noticed were hard to fix, but they did seem a little odd sometimes.  Here are some notes on my experiences with this process thus far:</p>\n<ol>\n<li>\n<h4>FreeTDS &#8211; Build</h4>\n<p>In order to get PHP talk to SQL Server 2000 I&#8217;m using <a href=\"http://www.freetds.org/\">FreeTDS</a> on a <a href=\"http://www.freebsd.org/\">FreeBSD</a> system.  The first thing to note is that SQL Server 2000 uses 8.0 TDS.  When building from FreeTDS from the ports collection be sure to override the default, which is 5.0.  You&#8217;ll also need to enable msdblib in FreeTDS, so make sure that WITH_MSDBLIB is enabled during the build also.  Then all that is needed for PHP4 to speak to SQL Server is the php4-mssql port.\n</li>\n<li>\n<h4>FreeTDS &#8211; Config</h4>\n<p>In recent versions of FreeTDS they&#8217;ve started using a <a href=\"http://www.freetds.org/userguide/freetdsconf.htm\">freetds.conf</a> file to configure connections.  There is an example in there for connecting to SQL Server 2000, here is what I ended up using:<br />\n<code><br />\n[SQL2K]<br />\n        host = xxx.xxx.xxx.xx<br />\n        port = 1433<br />\n        tds version = 8.0<br />\n;       dump file = /var/log/freetds.log<br />\n;       dump file append = yes<br />\n;       debug level = 99<br />\n</code></p>\n<p>I had a few problems connecting initially, so it was helpful to run with debug on until I got things straightened out.  In PHP you&#8217;d use SQL2K to connect instead of the host name or IP address.\n</li>\n<li>\n<h4>FreeTDS &#8211; Domain Logins</h4>\n<p>Our user accounts are all managed by <a href=\"http://www.microsoft.com/windowsserver2003/technologies/directory/activedirectory/default.mspx\">Active Directory</a>, besides the default accounts in SQL Server 2000 all of the permissions are handled via Windows domain accounts.  This means that all of your usernames have to be prefixed with the Windows domain.  Something like <code>EXAMPLEusername</code>.  If you run into problems check out the <a href=\"http://www.freetds.org/userguide/domains.htm\">FreeTDS documentation about domain logins</a>.\n</li>\n<li>\n<h4>SQL Server 2000 &#8211; Quoting</h4>\n<p>Note that quotes are escaped with quotes, not back slashes.  I personally don&#8217;t care for this method, but it seems to be the only one that SQL Server 2000 supports.  If you are going to use CSV to import data you need to pay attention to this.  Although CSV is supported I ended up going to tab delimited instead.  This is the default that SQL server expects and it made some of the quoting issues easier.\n</li>\n<li>\n<h4>ADOdb &#8211; rs2tabout()</h4>\n<p>For the sake of consistency I&#8217;m using ADOdb to deal with database access in PHP.  One neat feature I found was the ability to easily <a href=\"http://phplens.com/adodb/tutorial.exporting.in.csv.or.tab.delimited.format.html\">export a result set to CSV or tab delimited formats</a>.  This was exactly what I needed to do, so this seemed like a great solution.  Unfortunately rs2tabout() tries to escape quotes, which SQL Server choked on.  The quotes didn&#8217;t need to be escaped since tabs were being used as delimiters, so I poked at the code to see what was happening.  All of the export functions derive from a base function with several options, so I was able to call that function directly and override the defaults.  If you want data tab delimited with quote escaping turned off you can do that with:</p>\n<p><code>print(_adodb_export($rs, \"t\", \" \", true, false, false));</code></p>\n<p>or</p>\n<p><code>$line = _adodb_export($rs, \"t\", \" \", false, false, false);</code></p>\n</li>\n<li>\n<h4>bcp</h4>\n<p>Importing lots of data with <a href=\"http://msdn.microsoft.com/library/default.asp?url=/library/en-us/coprompt/cp_bcp_61et.asp\">bcp</a> is much easier than clicking through the import/export wizard.  To make life easier you&#8217;ll need a format file for the table that your are importing data into.  The easiest way I&#8217;ve found to generate the format file is to let bcp do it for you:<br />\n<code><br />\nbcp testdb.dbo.tablename format tablename.dat -U username -P password -f tablename.fmt -c<br />\n</code><br />\nThen importing is done like this:<br />\n<code><br />\nbcp testdb.dbo.tablename in tablename.tsv -U username -P password -f tablename.fmt -e tablename.err<br />\n</code><br />\nIf bcp has any problems importing data will be logged in the <code>tablename.err</code> file.  If it runs into enough errors the import will terminate, the default is ten.  In the test table that I&#8217;ve been using has 98,000+ records in it.  The process of retrieving the data and formating into tab separated values (tsv) takes about 110 seconds.  The import with bcp takes less than 5 seconds.  I like it when things go fast <img src=\"https://s.w.org/images/core/emoji/13.0.1/72x72/1f642.png\" alt=\"\ud83d\ude42\" class=\"wp-smiley\" style=\"height: 1em; max-height: 1em;\" />\n</li>\n</ol>\n<p>That pretty much covers it for now.</p>\n",
            "content_text": "We are purchasing some software at work that uses SQL Server 2000 as a back end.  I&#8217;ve been bringing those systems up and relearning SQL Server since I haven&#8217;t look at it in more than five years.  We&#8217;ll be importing some existing data for this software so I&#8217;ve started writing up a few scripts.  I&#8217;m using PHP with ADOdb for database access.  For the most part things have gone well, with some small expections/gotchas.  Fortunately none of the problems I noticed were hard to fix, but they did seem a little odd sometimes.  Here are some notes on my experiences with this process thus far:\n\n\nFreeTDS &#8211; Build\nIn order to get PHP talk to SQL Server 2000 I&#8217;m using FreeTDS on a FreeBSD system.  The first thing to note is that SQL Server 2000 uses 8.0 TDS.  When building from FreeTDS from the ports collection be sure to override the default, which is 5.0.  You&#8217;ll also need to enable msdblib in FreeTDS, so make sure that WITH_MSDBLIB is enabled during the build also.  Then all that is needed for PHP4 to speak to SQL Server is the php4-mssql port.\n\n\nFreeTDS &#8211; Config\nIn recent versions of FreeTDS they&#8217;ve started using a freetds.conf file to configure connections.  There is an example in there for connecting to SQL Server 2000, here is what I ended up using:\n\n[SQL2K]\n        host = xxx.xxx.xxx.xx\n        port = 1433\n        tds version = 8.0\n;       dump file = /var/log/freetds.log\n;       dump file append = yes\n;       debug level = 99\n\nI had a few problems connecting initially, so it was helpful to run with debug on until I got things straightened out.  In PHP you&#8217;d use SQL2K to connect instead of the host name or IP address.\n\n\nFreeTDS &#8211; Domain Logins\nOur user accounts are all managed by Active Directory, besides the default accounts in SQL Server 2000 all of the permissions are handled via Windows domain accounts.  This means that all of your usernames have to be prefixed with the Windows domain.  Something like EXAMPLEusername.  If you run into problems check out the FreeTDS documentation about domain logins.\n\n\nSQL Server 2000 &#8211; Quoting\nNote that quotes are escaped with quotes, not back slashes.  I personally don&#8217;t care for this method, but it seems to be the only one that SQL Server 2000 supports.  If you are going to use CSV to import data you need to pay attention to this.  Although CSV is supported I ended up going to tab delimited instead.  This is the default that SQL server expects and it made some of the quoting issues easier.\n\n\nADOdb &#8211; rs2tabout()\nFor the sake of consistency I&#8217;m using ADOdb to deal with database access in PHP.  One neat feature I found was the ability to easily export a result set to CSV or tab delimited formats.  This was exactly what I needed to do, so this seemed like a great solution.  Unfortunately rs2tabout() tries to escape quotes, which SQL Server choked on.  The quotes didn&#8217;t need to be escaped since tabs were being used as delimiters, so I poked at the code to see what was happening.  All of the export functions derive from a base function with several options, so I was able to call that function directly and override the defaults.  If you want data tab delimited with quote escaping turned off you can do that with:\nprint(_adodb_export($rs, \"t\", \" \", true, false, false));\nor\n$line = _adodb_export($rs, \"t\", \" \", false, false, false);\n\n\nbcp\nImporting lots of data with bcp is much easier than clicking through the import/export wizard.  To make life easier you&#8217;ll need a format file for the table that your are importing data into.  The easiest way I&#8217;ve found to generate the format file is to let bcp do it for you:\n\nbcp testdb.dbo.tablename format tablename.dat -U username -P password -f tablename.fmt -c\n\nThen importing is done like this:\n\nbcp testdb.dbo.tablename in tablename.tsv -U username -P password -f tablename.fmt -e tablename.err\n\nIf bcp has any problems importing data will be logged in the tablename.err file.  If it runs into enough errors the import will terminate, the default is ten.  In the test table that I&#8217;ve been using has 98,000+ records in it.  The process of retrieving the data and formating into tab separated values (tsv) takes about 110 seconds.  The import with bcp takes less than 5 seconds.  I like it when things go fast \n\n\nThat pretty much covers it for now.",
            "date_published": "2005-06-16T16:13:33-06:00",
            "date_modified": "2005-06-16T16:13:33-06:00",
            "authors": [
                {
                    "name": "josephscott",
                    "url": "https://blog.josephscott.org/author/josephscott/",
                    "avatar": "https://secure.gravatar.com/avatar/582b66ad5ae1b69c7601a990cb9a661a?s=512&d=mm&r=g"
                }
            ],
            "author": {
                "name": "josephscott",
                "url": "https://blog.josephscott.org/author/josephscott/",
                "avatar": "https://secure.gravatar.com/avatar/582b66ad5ae1b69c7601a990cb9a661a?s=512&d=mm&r=g"
            },
            "tags": [
                "adodb",
                "csv",
                "FreeBSD",
                "freetds",
                "PHP",
                "sqlserver",
                "josephscott"
            ]
        }
    ]
}