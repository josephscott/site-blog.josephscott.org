{
    "version": "https://jsonfeed.org/version/1.1",
    "user_comment": "This feed allows you to read the posts from this site in any feed reader that supports the JSON Feed format. To add this feed to your reader, copy the following URL -- https://blog.josephscott.org/tag/reverseproxy/feed/json/ -- and add it your reader.",
    "home_page_url": "https://blog.josephscott.org/tag/reverseproxy/",
    "feed_url": "https://blog.josephscott.org/tag/reverseproxy/feed/json/",
    "language": "en-US",
    "title": "reverseproxy &#8211; Joseph Scott",
    "items": [
        {
            "id": "http://joseph.randomnetworks.com/?p=427",
            "url": "https://blog.josephscott.org/2005/07/05/reverse-proxy-with-apache/",
            "title": "Reverse Proxy With Apache",
            "content_html": "<p>I&#8217;ve wanted to get all of our web servers at work under one umbrella in a reverse proxy setup for some time.  I wanted this so that I could expose only one web server to the outside world (some of this has to do with network topology that is beyond my control), allowing me make all of our web services available under one URL (nice for things like SSL and multiple URL rewriting) and making it possible to filter web requests at one place.  Today I finally sat down with the intent to make it work and plan for the switch over.</p>\n<p>In the past I&#8217;d looked at doing this with <a href=\"http://www.apsis.ch/pound/\">Pound</a>, but it fell short in one key area, URL rewriting.  Everything else I needed was already there, in one convenient spot.  I really wanted this to work, but in the end I couldn&#8217;t give up URL rewriting, it&#8217;s a requirement for what I&#8217;m trying to accomplish.  I also looked at <a href=\"http://www.squid-cache.org/\">Squid</a> for a time.  Honestly I didn&#8217;t complete my trial of Squid, it is possible that it might me all of my requirements, but I didn&#8217;t see anything that looked like <a href=\"http://www.modsecurity.org/\">mod_security</a> for Squid.  That was another needed feature, I&#8217;m trying to protect IIS servers so I wanted all the extra help I could get.</p>\n<p>So I eventually ended up at <a href=\"http://httpd.apache.org/\">Apache</a>, with mod_proxy.  With the help of <a href=\"http://www.apacheweek.com/features/reverseproxies\">this how to article</a> things went pretty smoothly.  Until I tried to bring the server hosting our <a href=\"http://www.squirrelmail.org/\">Squirrelmail</a> install.  No matter what I tried I could get to successfully login.  Suspecting that this had to with cookies being based between the client, proxy and server I went hunting for web on the web.  Turns out the how to article above mentions a couple of proxy directives for dealing with this, <a href=\"http://httpd.apache.org/docs-2.1/mod/mod_proxy.html#proxypassreversecookiedomain\">ProxyPassReverseCookieDomain</a> and <a href=\"http://httpd.apache.org/docs-2.1/mod/mod_proxy.html#proxypassreversecookiepath\">ProxyPassReverseCookiePath</a>.  Unfortunately these are only available in the development version of Apache, version 2.1.  I&#8217;d spent the better part day of the tweaking my install of Apache 2.0.54 and then had to go build Apache 2.1.x to get the newer version mod_proxy.  Some of the module names have changed so I couldn&#8217;t just drop in my previous Apache config.  I also had to rebuild the <a href=\"http://apache.webthing.com/mod_proxy_html/\">mod_proxy_html</a> and mod_security modules for Apache 2.1.x.</p>\n<p>The good news is that once I had that all sorted out the new proxy cookie directives did the trick.  So here is my little public service announcement (PSA), if you are using mod_proxy as a reverse proxy for Squirrelmail, start with Apache 2.1.x and look into ProxyPassReverseCookieDomain and ProxyPassReverseCookiePath.  I suspect this will be the case for any webapp that uses cookies.</p>\n<p>I haven&#8217;t added mod_security and SSL to the mix yet, but I&#8217;m already familiar with those modules, so I don&#8217;t expect that to be too bad.  I&#8217;d never really used mod_proxy as a reverse proxy before so this was some what new territory to me.  Oh, at some point I&#8217;ll look doing some caching in combination with reverse proxy to minimize the load on the back end web servers.</p>\n<p><strong>UPDATE 10:45am 6 Jul 2005:</strong>: I should have mentioned the trailing slash problem also shows up in the reverse proxy setup.  So if you have a reverse mapping that looks something like:</p>\n<blockquote><p><code>ProxyPass /webmail/ http://192.168.1.10/webmail/</code></p></blockquote>\n<p> then you can use mod_rewrite to send a redirect with the trailing slash:</p>\n<blockquote><p><code>RewriteRule ^/webmail$ webmail/ [R]</code></p></blockquote>\n",
            "content_text": "I&#8217;ve wanted to get all of our web servers at work under one umbrella in a reverse proxy setup for some time.  I wanted this so that I could expose only one web server to the outside world (some of this has to do with network topology that is beyond my control), allowing me make all of our web services available under one URL (nice for things like SSL and multiple URL rewriting) and making it possible to filter web requests at one place.  Today I finally sat down with the intent to make it work and plan for the switch over.\nIn the past I&#8217;d looked at doing this with Pound, but it fell short in one key area, URL rewriting.  Everything else I needed was already there, in one convenient spot.  I really wanted this to work, but in the end I couldn&#8217;t give up URL rewriting, it&#8217;s a requirement for what I&#8217;m trying to accomplish.  I also looked at Squid for a time.  Honestly I didn&#8217;t complete my trial of Squid, it is possible that it might me all of my requirements, but I didn&#8217;t see anything that looked like mod_security for Squid.  That was another needed feature, I&#8217;m trying to protect IIS servers so I wanted all the extra help I could get.\nSo I eventually ended up at Apache, with mod_proxy.  With the help of this how to article things went pretty smoothly.  Until I tried to bring the server hosting our Squirrelmail install.  No matter what I tried I could get to successfully login.  Suspecting that this had to with cookies being based between the client, proxy and server I went hunting for web on the web.  Turns out the how to article above mentions a couple of proxy directives for dealing with this, ProxyPassReverseCookieDomain and ProxyPassReverseCookiePath.  Unfortunately these are only available in the development version of Apache, version 2.1.  I&#8217;d spent the better part day of the tweaking my install of Apache 2.0.54 and then had to go build Apache 2.1.x to get the newer version mod_proxy.  Some of the module names have changed so I couldn&#8217;t just drop in my previous Apache config.  I also had to rebuild the mod_proxy_html and mod_security modules for Apache 2.1.x.\nThe good news is that once I had that all sorted out the new proxy cookie directives did the trick.  So here is my little public service announcement (PSA), if you are using mod_proxy as a reverse proxy for Squirrelmail, start with Apache 2.1.x and look into ProxyPassReverseCookieDomain and ProxyPassReverseCookiePath.  I suspect this will be the case for any webapp that uses cookies.\nI haven&#8217;t added mod_security and SSL to the mix yet, but I&#8217;m already familiar with those modules, so I don&#8217;t expect that to be too bad.  I&#8217;d never really used mod_proxy as a reverse proxy before so this was some what new territory to me.  Oh, at some point I&#8217;ll look doing some caching in combination with reverse proxy to minimize the load on the back end web servers.\nUPDATE 10:45am 6 Jul 2005:: I should have mentioned the trailing slash problem also shows up in the reverse proxy setup.  So if you have a reverse mapping that looks something like:\nProxyPass /webmail/ http://192.168.1.10/webmail/\n then you can use mod_rewrite to send a redirect with the trailing slash:\nRewriteRule ^/webmail$ webmail/ [R]",
            "date_published": "2005-07-05T15:21:23-06:00",
            "date_modified": "2005-07-05T15:21:23-06:00",
            "authors": [
                {
                    "name": "josephscott",
                    "url": "https://blog.josephscott.org/author/josephscott/",
                    "avatar": "https://secure.gravatar.com/avatar/582b66ad5ae1b69c7601a990cb9a661a?s=512&d=mm&r=g"
                }
            ],
            "author": {
                "name": "josephscott",
                "url": "https://blog.josephscott.org/author/josephscott/",
                "avatar": "https://secure.gravatar.com/avatar/582b66ad5ae1b69c7601a990cb9a661a?s=512&d=mm&r=g"
            },
            "tags": [
                "apache",
                "howto",
                "reverseproxy",
                "squirrelmail",
                "josephscott"
            ]
        }
    ]
}