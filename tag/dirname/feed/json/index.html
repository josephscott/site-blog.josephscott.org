{
    "version": "https://jsonfeed.org/version/1.1",
    "user_comment": "This feed allows you to read the posts from this site in any feed reader that supports the JSON Feed format. To add this feed to your reader, copy the following URL -- https://blog.josephscott.org/tag/dirname/feed/json/ -- and add it your reader.",
    "home_page_url": "https://blog.josephscott.org/tag/dirname/",
    "feed_url": "https://blog.josephscott.org/tag/dirname/feed/json/",
    "language": "en-US",
    "title": "dirname &#8211; Joseph Scott",
    "items": [
        {
            "id": "http://josephscott.org/?p=2147",
            "url": "https://blog.josephscott.org/2010/04/08/efficient-php-dont-abuse-dirname-__file__/",
            "title": "Efficient PHP: Don\u2019t Abuse dirname( __FILE__ )",
            "content_html": "<p>Every now and then I run across a chunk of PHP code at the top of a file that looks something like this:</p>\n<p>[sourcecode lang=&#8221;php&#8221;]<br />\nrequire dirname( __FILE__ ) . &#8216;/path/to/something.php&#8217;;<br />\nrequire dirname( __FILE__ ) . &#8216;/path/to/another.php&#8217;;<br />\nrequire dirname( __FILE__ ) . &#8216;/path/to/me-too.php&#8217;;<br />\nrequire dirname( __FILE__ ) . &#8216;/path/to/sure-why-not.php&#8217;;<br />\nrequire dirname( __FILE__ ) . &#8216;/path/to/kitchen-sink.php&#8217;;<br />\n[/sourcecode]</p>\n<p>and what jumps out at me is the repeated use of <code>dirname( __FILE__ )</code> for each require statement (for now we&#8217;ll avoid asking why anyone would need to include the kitchen-sink in their code base).  My gut instinct is to call <code>dirname( __FILE__ )</code> once, save that in a variable and then reference the variable to build the path.  Not wanting to go on instinct alone I put together a small test to see if it really would make any difference.</p>\n<p>The contrived test code will compare approach A:</p>\n<p>[sourcecode lang=&#8221;php&#8221;]<br />\n$var = dirname( __FILE__ ) . &#8216;/path/to/something.php&#8217;;<br />\n$var = dirname( __FILE__ ) . &#8216;/path/to/another.php&#8217;;<br />\n$var = dirname( __FILE__ ) . &#8216;/path/to/me-too.php&#8217;;<br />\n$var = dirname( __FILE__ ) . &#8216;/path/to/sure-why-not.php&#8217;;<br />\n$var = dirname( __FILE__ ) . &#8216;/path/to/kitchen-sink.php&#8217;;<br />\n[/sourcecode]</p>\n<p>with approach B:</p>\n<p>[sourcecode lang=&#8221;php&#8221;]<br />\n$path = dirname( __FILE__ );</p>\n<p>$var = $path . &#8216;/path/to/something.php&#8217;;<br />\n$var = $path . &#8216;/path/to/another.php&#8217;;<br />\n$var = $path . &#8216;/path/to/me-too.php&#8217;;<br />\n$var = $path . &#8216;/path/to/sure-why-not.php&#8217;;<br />\n$var = $path . &#8216;/path/to/kitchen-sink.php&#8217;;<br />\n[/sourcecode]</p>\n<p>I&#8217;m not testing with <code>require</code> in an effort to focus just on the difference repeated <code>dirname( __FILE__ )</code> calls make, not how fast the filesystem can slurp in PHP libraries.</p>\n<h3>VLD</h3>\n<p>My first test was to pass each approach through <a href=\"http://derickrethans.nl/projects.html#vld\">VLD</a> to see how much &#8220;work&#8221; PHP was doing.    For that I pulled out the number of operations needed for each approach:</p>\n<p><b>approach A:</b> 37 ops<br />\n<b>approach B:</b> 23 ops</p>\n<p>Calling <code>dirname( __FILE__ )</code> once required 37% fewer operations.  This is a bit of blunt measurement since it doesn&#8217;t attempt to give individual weights to the different operations, but it gives a good general view.  The rule of thumb is that fewer ops is better than more ops.</p>\n<h3>Time</h3>\n<p>I tried running each approach in a simple loop, but it always ran so quickly that I didn&#8217;t see any useful difference.</p>\n<h4>Memory</h4>\n<p>Next up was a look at <a href=\"http://us.php.net/manual/en/function.memory-get-peak-usage.php\">memory_get_peak_usage</a>.  Turns out there was a small difference:</p>\n<p><b>approach A:</b> 57,312 bytes<br />\n<b>approach B:</b> 56,992 bytes</p>\n<p>Sure 320 bytes isn&#8217;t a big deal in the world of servers with 16GB of memory, but it&#8217;s one more reason why approach B is just that tiny bit better.</p>\n<h4>Conclusion</h4>\n<p>If you see this pattern creeping into your code base and you can easily convert it then you&#8217;ll likely be better off for it.  Remember that everything is a trade off though, if it takes you several hours to go through and make this kind of change it may not be worth it.</p>\n<p>I&#8217;d certainly file this away for new projects though so that you can avoid repetitive <code>dirname( __FILE__ )</code> calls from the start.  For that matter, if you can get away with running on 5.3 or higher then you&#8217;d probably want to skip this entirely and look at using the new <a href=\"http://us.php.net/manual/en/language.constants.predefined.php\">__DIR__</a> constant.  I haven&#8217;t tested how it compares to the two approaches listed above, but I&#8217;d expect it to be at least as good as approach B, perhaps even better.</p>\n<p>For reference I tested this using PHP 5.2.10-2ubuntu6.4 with Suhosin-Patch 0.9.7 (cli) (built: Jan  6 2010 22:41:56).  Your specific version of PHP may behave differently.</p>\n",
            "content_text": "Every now and then I run across a chunk of PHP code at the top of a file that looks something like this:\n[sourcecode lang=&#8221;php&#8221;]\nrequire dirname( __FILE__ ) . &#8216;/path/to/something.php&#8217;;\nrequire dirname( __FILE__ ) . &#8216;/path/to/another.php&#8217;;\nrequire dirname( __FILE__ ) . &#8216;/path/to/me-too.php&#8217;;\nrequire dirname( __FILE__ ) . &#8216;/path/to/sure-why-not.php&#8217;;\nrequire dirname( __FILE__ ) . &#8216;/path/to/kitchen-sink.php&#8217;;\n[/sourcecode]\nand what jumps out at me is the repeated use of dirname( __FILE__ ) for each require statement (for now we&#8217;ll avoid asking why anyone would need to include the kitchen-sink in their code base).  My gut instinct is to call dirname( __FILE__ ) once, save that in a variable and then reference the variable to build the path.  Not wanting to go on instinct alone I put together a small test to see if it really would make any difference.\nThe contrived test code will compare approach A:\n[sourcecode lang=&#8221;php&#8221;]\n$var = dirname( __FILE__ ) . &#8216;/path/to/something.php&#8217;;\n$var = dirname( __FILE__ ) . &#8216;/path/to/another.php&#8217;;\n$var = dirname( __FILE__ ) . &#8216;/path/to/me-too.php&#8217;;\n$var = dirname( __FILE__ ) . &#8216;/path/to/sure-why-not.php&#8217;;\n$var = dirname( __FILE__ ) . &#8216;/path/to/kitchen-sink.php&#8217;;\n[/sourcecode]\nwith approach B:\n[sourcecode lang=&#8221;php&#8221;]\n$path = dirname( __FILE__ );\n$var = $path . &#8216;/path/to/something.php&#8217;;\n$var = $path . &#8216;/path/to/another.php&#8217;;\n$var = $path . &#8216;/path/to/me-too.php&#8217;;\n$var = $path . &#8216;/path/to/sure-why-not.php&#8217;;\n$var = $path . &#8216;/path/to/kitchen-sink.php&#8217;;\n[/sourcecode]\nI&#8217;m not testing with require in an effort to focus just on the difference repeated dirname( __FILE__ ) calls make, not how fast the filesystem can slurp in PHP libraries.\nVLD\nMy first test was to pass each approach through VLD to see how much &#8220;work&#8221; PHP was doing.    For that I pulled out the number of operations needed for each approach:\napproach A: 37 ops\napproach B: 23 ops\nCalling dirname( __FILE__ ) once required 37% fewer operations.  This is a bit of blunt measurement since it doesn&#8217;t attempt to give individual weights to the different operations, but it gives a good general view.  The rule of thumb is that fewer ops is better than more ops.\nTime\nI tried running each approach in a simple loop, but it always ran so quickly that I didn&#8217;t see any useful difference.\nMemory\nNext up was a look at memory_get_peak_usage.  Turns out there was a small difference:\napproach A: 57,312 bytes\napproach B: 56,992 bytes\nSure 320 bytes isn&#8217;t a big deal in the world of servers with 16GB of memory, but it&#8217;s one more reason why approach B is just that tiny bit better.\nConclusion\nIf you see this pattern creeping into your code base and you can easily convert it then you&#8217;ll likely be better off for it.  Remember that everything is a trade off though, if it takes you several hours to go through and make this kind of change it may not be worth it.\nI&#8217;d certainly file this away for new projects though so that you can avoid repetitive dirname( __FILE__ ) calls from the start.  For that matter, if you can get away with running on 5.3 or higher then you&#8217;d probably want to skip this entirely and look at using the new __DIR__ constant.  I haven&#8217;t tested how it compares to the two approaches listed above, but I&#8217;d expect it to be at least as good as approach B, perhaps even better.\nFor reference I tested this using PHP 5.2.10-2ubuntu6.4 with Suhosin-Patch 0.9.7 (cli) (built: Jan  6 2010 22:41:56).  Your specific version of PHP may behave differently.",
            "date_published": "2010-04-08T08:26:39-06:00",
            "date_modified": "2010-04-08T08:26:39-06:00",
            "authors": [
                {
                    "name": "josephscott",
                    "url": "https://blog.josephscott.org/author/josephscott/",
                    "avatar": "https://secure.gravatar.com/avatar/582b66ad5ae1b69c7601a990cb9a661a?s=512&d=mm&r=g"
                }
            ],
            "author": {
                "name": "josephscott",
                "url": "https://blog.josephscott.org/author/josephscott/",
                "avatar": "https://secure.gravatar.com/avatar/582b66ad5ae1b69c7601a990cb9a661a?s=512&d=mm&r=g"
            },
            "tags": [
                "dirname",
                "performance",
                "PHP",
                "Posts"
            ]
        }
    ]
}